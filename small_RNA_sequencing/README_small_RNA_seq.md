The data files and analysis scripts deposited here relate to the sRNA analysis done in the paper “COVID-19 vaccination is associated with attenuation of inflammatory responses during breakthrough disease: revelations from a multi-omics analysis” by Drury, Camara and Chelysheva et al. To understand timepoints, cohorts etc, then please read that paper. 

Any reference to “pilot” refers to datasets and analysis relating to the stage I cohort in the paper.  Any reference to “extension” or “EXT” refers to datasets and analysis relating to the stage II cohort in the paper. 
D7 is the same as CT+7 in the paper
D0 is the same as baseline in the paper

Some of the code in these scripts are exploratory analyses, the results of which were not included in the final paper due to the targetted scope of the paper.


Primary Analysis files:
"COVID stage I.Rmd" - This contains the differential expression script for the stage I cohort. It also contains code for visualising quality control output and the differential expression results. There is also code on exploratory data analysis e.g. PCA. 

"COVID stage II sRNA script.Rmd" - As above but for the stage II cohort. 

"COVID sRNA upload to MIEAA2 for GSEA.Rmd" - Prints out differential expression results for whichever analysis the user is interested in. These differential expression lists can be input into MIEAA2 for gene set analysis. 

"COVID stage I sRNA comparing pathway enrichment script.Rmd" – takes the output of the MIEAA2 for gene set analyses so that they can be visualised and compared between different groups and timepoints.

"COVID stage II sRNA comparing pathway enrichment script.Rmd" As above but for the stage II data

"COVID compare mRNA and sRNA results at pathway and system level.Rmd" – integrates mRNA and miRNA results to look for similarities between the two transcriptomic datasets. 

Sourced files in the above scripts:

Scripts called in "COVID stage I.Rmd":
"COVID_stage1_sRNA_contrast matrix_cell_counts.R"
"COVID_stage1_sRNA_contrast_matrix.R"
"COVID_stage1_sRNA_contrast_matrix_cell counts_no_D0.R"

Scripts called in "COVID stage II.Rmd":
"COVID_stage2_contrast_matrix_cell counts no D0.R"
"COVID_stage2_sRNA_contrast matrix.R"
"COVID_stage2_sRNA_contrast_matrix_include_batch_and_red_cells.R"

Script called in several scripts:
"rename ENSG with gene symbol in any collapse option.R" – creates shortened names for sRNA features e.g. for use in tables and plots where very long names are undersirable. 

Data files
Meta data:
"COVID_stage1_sRNA_metadata.xlsx"
"COVID_stage2_metadata.xlsx"
"COVID_stage1_lcpm_totalcounts4_IDlink.RData" – meta data table for stage I that is in the same order as one of the gene expression tables that has been manipulated in the script. 

Raw, unnormalized sRNA count data:
"COVID_stage1_sRNA_raw_count_matrix.RDS" 
"COVID_stage2_sRNA_raw_count_matrix.RDS"

Object containing all results tables generated by the differential expression analysis. For information on how to use them see below. 
"COVID_stage1_sRNA_analyses_results_fit_object.RData"
"COVID_stage2_analyses_results_fit_object.RData"

 MIEAA2 results:
"COVID_stage1_sRNA_MIEAA_all_results.RDS"
"COVID_stage2_sRNA_MIEAA2_results.RDS"
"COVID_stage2_consolidated.mieaa2.enrichment.table.RDS"

mRNA differential expression results table:

"BRC_COVID_omicsD0_CT_PCRpos_Table_of_collapsed_gene_results_STAR_HTSeq_limma_paired_grch38_2021-05-06.txt" – stage I DEG results table for CT baseline

"COVID_omics_follow_upD0_CT_MENACWY_Table_of_collapsed_gene_results_STAR_HTSeq_limma_paired_grch38_2021-12-09.txt" – stage II DEG results table for CT baseline


mRNA gene set enrichment results for GO:BP – used in "COVID compare mRNA and sRNA results at pathway and system level.Rmd"
"mRNA_stage1_GSEA_results.zip"
"mRNA_stage2_GSEA_results.zip"

"GO categories.txt" – used in "COVID stage I sRNA comparing pathway enrichment script.Rmd" and "COVID stage II sRNA comparing pathway enrichment script.Rmd" to pick out GO:BP terms

Using the files: 
The working directory will need to be manually set by the user so that it points to the download location of all scripts and data files (they should be downloaded to the same folder for the scripts to work well). If they are not, the user will have to manually alter the file paths.

Accessing differential gene expression results
The differential analysis scripts automatically output the results of all contrasts e.g. baseline vs CT, CT menACWY vs CT ChAdOx1 nCoV-19. The results tables are saved as lists. In stage I, these  results are contained in COVID_stage1_sRNA_analyses_results_fit_object.RData  
This object loads the following:

pilot.analysis.1 - These are the results when an unpaired analysis is used and red cells are not controlled for e.g. baseline vs CT. Use in any analysis including baseline samples as there were no paired baseline samples in stage II. 

pilot.analysis.2 - These are the results when a non-paired analysis is used and red cells are controlled for. These results can be useful for looking at cross-sectional analyses

pilot.analysis.3 - These are the results when a paired analysis is used and red cells are controlled for – useful in longitudinal comparisons e.g. CT vs D7

pilot_contrast.options_analysis.1 – tells you where in pilot.analysis.1 the result of each contrast is. 
pilot_contrast.options_analysis.2 – tells you where in pilot.analysis.2 the result of each contrast is.
pilot_contrast.options_analysis.3 – tells you where in pilot.analysis.3 the result of each contrast is.

To access a particular differential gene expression results table, look up the contrast name in the appropriate contrast.options table – this tells you what the contrast is called and where in the associated list your results table can be found. 




